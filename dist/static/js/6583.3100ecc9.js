/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-08-21 17:45:49
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[6583,8964],{30345:function(e,t,l){l.d(t,{Ed:function(){return n},pL:function(){return r},vS:function(){return a},wN:function(){return s}});var o=l(80484);function a(e){return(0,o.A)({url:"/role/getList",method:"get",params:e})}function s(){return(0,o.A)({url:"/role/getNodes",method:"get"})}function n(e){return(0,o.A)({url:"/role/doEdit",method:"post",data:e})}function r(e){return(0,o.A)({url:"/role/doDelete",method:"post",data:e})}},46583:function(e,t,l){l.r(t),l.d(t,{default:function(){return R}});var o=l(72638),a=(l(25638),l(56197),l(24707)),s=(l(91697),l(29313)),n=(l(11501),l(20355)),r=(l(76869),l(14072),l(64635)),d=(l(70175),l(12118),l(35084)),i=(l(70752),l(57305)),u=l(75916);const m={class:"vab-tree-border"};function f(e,t,l,f,c,b){const k=d.WK,p=s.xE,h=r.q,v=n.dI,g=n.o5,R=s.US,_=a.S2,C=o.kZ;return(0,i.uX)(),(0,i.Wv)(C,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[3]||(t[3]=t=>e.dialogFormVisible=t),title:e.title,width:"500px",onClose:e.close},{footer:(0,i.k6)((()=>[(0,i.bF)(_,{onClick:e.close},{default:(0,i.k6)((()=>[(0,i.eW)("取 消")])),_:1},8,["onClick"]),(0,i.bF)(_,{type:"primary",onClick:e.save},{default:(0,i.k6)((()=>[(0,i.eW)("确 定")])),_:1},8,["onClick"])])),default:(0,i.k6)((()=>[(0,i.bF)(R,{ref:"formRef","label-width":"80px",model:e.form,rules:e.rules},{default:(0,i.k6)((()=>[(0,i.bF)(p,{label:"角色码",prop:"name"},{default:(0,i.k6)((()=>[(0,i.bF)(k,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.name=t)},null,8,["modelValue"])])),_:1}),(0,i.bF)(p,{label:"菜单"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",m,[(0,i.bF)(h,{ref:"treeRef",modelValue:e.menuIds,"onUpdate:modelValue":t[1]||(t[1]=t=>e.menuIds=t),data:e.list,"default-expanded-keys":[],"node-key":"id","show-checkbox":""},{default:(0,i.k6)((({data:e})=>[(0,i.Lk)("span",null,(0,u.v_)(e.meta.title),1)])),_:1},8,["modelValue","data"])])])),_:1}),(0,i.bF)(p,{label:"按钮权限"},{default:(0,i.k6)((()=>[(0,i.bF)(g,{modelValue:e.form.btnRolesCheckedList,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.btnRolesCheckedList=t)},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.btnRoles,(e=>((0,i.uX)(),(0,i.Wv)(v,{key:e.value,label:e.value},{default:(0,i.k6)((()=>[(0,i.eW)((0,u.v_)(e.lable),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","onClose"])}var c=l(27011),b=l(30345),k=l(70817),p=(0,i.pM)({name:"RoleManagementEdit",emits:["fetch-data"],setup(e,{emit:t}){const l=(0,i.WQ)("$baseMessage"),o=(0,k.Kh)({formRef:null,treeRef:null,form:{btnRolesCheckedList:[]},menuIds:[],rules:{name:[{required:!0,trigger:"blur",message:"请输入角色名称"}]},title:"",dialogFormVisible:!1,list:[],btnRoles:[{lable:"读",value:"read:system"},{lable:"写",value:"write:system"},{lable:"删",value:"delete:system"}]}),a=async e=>{e?(o.title="编辑",o.form=JSON.parse(JSON.stringify(e)),o.form.btnRolesCheckedList=e.permissions.split(","),(0,i.dY)((()=>{e.menu_ids.split(",").forEach((e=>{const t=o.treeRef.getNode(e);t.isLeaf&&o.treeRef.setChecked(t,!0)}))}))):o.title="添加",o.dialogFormVisible=!0},s=()=>{o["formRef"].resetFields(),o["treeRef"].setCheckedKeys([]),o.form={btnRolesCheckedList:[]},o.dialogFormVisible=!1},n=async()=>{const{data:{list:e}}=await(0,c.v)();o.list=e},r=()=>{o["formRef"].validate((async e=>{if(e){const e=o["treeRef"].getCheckedNodes(!1,!0).map((e=>e.id));o.form.permissions=o.form.btnRolesCheckedList.join(","),o.form.menu_ids=e.join(",");const{msg:a}=await(0,b.Ed)({...o.form});l(a,"success","vab-hey-message-success"),t("fetch-data"),s()}}))};return(0,i.sV)((()=>{n()})),{...(0,k.QW)(o),showEdit:a,close:s,fetchData:n,save:r}}});function h(e){e.__source="src/views/setting/role/components/RoleManagementEdit.vue"}var v=l(88093);"function"===typeof h&&h(p);const g=(0,v.A)(p,[["render",f],["__scopeId","data-v-88dbe2aa"]]);var R=g}}]);